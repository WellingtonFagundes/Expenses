/*
Created: 03/04/2018
Modified: 15/05/2018
Model: Microsoft SQL Server 2016
Database: MS SQL Server 2016
*/


-- Create tables section -------------------------------------------------

-- Table TB_USUARIOS

CREATE TABLE [TB_USUARIOS]
(
 [USU_CODIGO] Int IDENTITY NOT NULL,
 [USU_NOME] Varchar(70) NOT NULL,
 [USU_EMAIL] Varchar(250) NOT NULL,
 [USU_SENHA] Varchar(200) NOT NULL,
 [USU_CARGO] Varchar(200) NOT NULL,
 [USU_EXCLUIDO] Datetime NULL,
 [USU_ADMINISTRADOR] Bit NULL,
 [USU_PERCODIGO] Int NOT NULL,
 [USU_PATHIMAGE] Varchar(400) NOT NULL
)
go

-- Add keys for table TB_USUARIOS

ALTER TABLE [TB_USUARIOS] ADD CONSTRAINT [PK_TB_USUARIOS] PRIMARY KEY ([USU_CODIGO])
go

-- Table TB_PERFIL

CREATE TABLE [TB_PERFIL]
(
 [PER_CODIGO] Int IDENTITY NOT NULL,
 [PER_NOME] Varchar(100) NOT NULL,
 [PER_DIFERENCIADO] Bit NOT NULL
)
go

-- Add keys for table TB_PERFIL

ALTER TABLE [TB_PERFIL] ADD CONSTRAINT [PK_TB_PERFIL] PRIMARY KEY ([PER_CODIGO])
go

-- Table TB_DESPESA

CREATE TABLE [TB_DESPESA]
(
 [DES_CODIGO] Int IDENTITY NOT NULL,
 [DES_DESCRICAO] Varchar(350) NOT NULL,
 [DES_VALOR] Decimal(18,0) NOT NULL,
 [DES_STATUS] Int NOT NULL,
 [DES_FOPCODIGO] Int NOT NULL,
 [DES_USUCODIGO] Int NOT NULL,
 [DES_VIGCODIGO] Int NOT NULL
)
go

-- Add keys for table TB_DESPESA

ALTER TABLE [TB_DESPESA] ADD CONSTRAINT [PK_TB_DESPESA] PRIMARY KEY ([DES_CODIGO])
go

-- Table TB_FORMA_PAGAMENTO

CREATE TABLE [TB_FORMA_PAGAMENTO]
(
 [FOP_CODIGO] Int IDENTITY NOT NULL,
 [FOP_DESCRICAO] Varchar(100) NOT NULL
)
go

-- Add keys for table TB_FORMA_PAGAMENTO

ALTER TABLE [TB_FORMA_PAGAMENTO] ADD CONSTRAINT [PK_TB_FORMA_PAGAMENTO] PRIMARY KEY ([FOP_CODIGO])
go

-- Table TB_VIGENCIA

CREATE TABLE [TB_VIGENCIA]
(
 [VIG_CODIGO] Int IDENTITY NOT NULL,
 [VIG_DATAINICIO] Datetime NOT NULL,
 [VIG_DATAFINAL] Datetime NOT NULL,
 [VIG_USUCODIGO] Int NOT NULL
)
go

-- Add keys for table TB_VIGENCIA

ALTER TABLE [TB_VIGENCIA] ADD CONSTRAINT [PK_TB_VIGENCIA] PRIMARY KEY ([VIG_CODIGO])
go

-- Table TB_CARTAO_CREDITO

CREATE TABLE [TB_CARTAO_CREDITO]
(
 [CAC_CODIGO] Int IDENTITY NOT NULL,
 [CAC_COMPRA] Varchar(100) NOT NULL,
 [CAC_VALORMES] Decimal(18,0) NOT NULL,
 [CAC_PARCELAS] Int NOT NULL,
 [CAC_TOTAL] Decimal(18,0) NOT NULL,
 [CAC_VIGCODIGO] Int NOT NULL,
 [CAC_USUCODIGO] Int NOT NULL
)
go

-- Add keys for table TB_CARTAO_CREDITO

ALTER TABLE [TB_CARTAO_CREDITO] ADD CONSTRAINT [PK_TB_CARTAO_CREDITO] PRIMARY KEY ([CAC_CODIGO])
go

-- Table TB_RECEITA

CREATE TABLE [TB_RECEITA]
(
 [REC_CODIGO] Int IDENTITY NOT NULL,
 [REC_DESCRICAO] Varchar(200) NOT NULL,
 [REC_VALOR] Decimal(18,0) NOT NULL,
 [REC_VIGCODIGO] Int NOT NULL,
 [REC_USUCODIGO] Int NOT NULL
)
go

-- Add keys for table TB_RECEITA

ALTER TABLE [TB_RECEITA] ADD CONSTRAINT [PK_TB_RECEITA] PRIMARY KEY ([REC_CODIGO])
go

-- Table TB_COMPRAS_FUTURAS

CREATE TABLE [TB_COMPRAS_FUTURAS]
(
 [COF_CODIGO] Int IDENTITY NOT NULL,
 [COF_DESCRICAO] Varchar(300) NOT NULL,
 [COF_VALOR] Decimal(18,0) NOT NULL,
 [COF_STATUS] Int NOT NULL,
 [COF_URL] Varchar(max) NOT NULL,
 [COF_PATHIMAGE] Varchar(300) NULL,
 [COF_ARQUIVOIMAGE] Varchar(150) NULL,
 [COF_USUCODIGO] Int NOT NULL
)
go

-- Add keys for table TB_COMPRAS_FUTURAS

ALTER TABLE [TB_COMPRAS_FUTURAS] ADD CONSTRAINT [PK_TB_COMPRAS_FUTURAS] PRIMARY KEY ([COF_CODIGO])
go

-- Create foreign keys (relationships) section ------------------------------------------------- 


ALTER TABLE [TB_USUARIOS] ADD CONSTRAINT [FK_USUPERCODIGO] FOREIGN KEY ([USU_PERCODIGO]) REFERENCES [TB_PERFIL] ([PER_CODIGO]) ON UPDATE NO ACTION ON DELETE NO ACTION
go


ALTER TABLE [TB_DESPESA] ADD CONSTRAINT [FK_DESFOPCODIGO] FOREIGN KEY ([DES_FOPCODIGO]) REFERENCES [TB_FORMA_PAGAMENTO] ([FOP_CODIGO]) ON UPDATE NO ACTION ON DELETE NO ACTION
go


ALTER TABLE [TB_DESPESA] ADD CONSTRAINT [FK_DESUSUCODIGO] FOREIGN KEY ([DES_USUCODIGO]) REFERENCES [TB_USUARIOS] ([USU_CODIGO]) ON UPDATE NO ACTION ON DELETE NO ACTION
go


ALTER TABLE [TB_DESPESA] ADD CONSTRAINT [FK_DESVIGCODIGO] FOREIGN KEY ([DES_VIGCODIGO]) REFERENCES [TB_VIGENCIA] ([VIG_CODIGO]) ON UPDATE NO ACTION ON DELETE NO ACTION
go


ALTER TABLE [TB_CARTAO_CREDITO] ADD CONSTRAINT [FK_CACVIGCODIGO] FOREIGN KEY ([CAC_VIGCODIGO]) REFERENCES [TB_VIGENCIA] ([VIG_CODIGO]) ON UPDATE NO ACTION ON DELETE NO ACTION
go


ALTER TABLE [TB_CARTAO_CREDITO] ADD CONSTRAINT [FK_CACUSUCODIGO] FOREIGN KEY ([CAC_USUCODIGO]) REFERENCES [TB_USUARIOS] ([USU_CODIGO]) ON UPDATE NO ACTION ON DELETE NO ACTION
go


ALTER TABLE [TB_RECEITA] ADD CONSTRAINT [FK_RECVIGCODIGO] FOREIGN KEY ([REC_VIGCODIGO]) REFERENCES [TB_VIGENCIA] ([VIG_CODIGO]) ON UPDATE NO ACTION ON DELETE NO ACTION
go


ALTER TABLE [TB_RECEITA] ADD CONSTRAINT [FK_RECUSUCODIGO] FOREIGN KEY ([REC_USUCODIGO]) REFERENCES [TB_USUARIOS] ([USU_CODIGO]) ON UPDATE NO ACTION ON DELETE NO ACTION
go


ALTER TABLE [TB_COMPRAS_FUTURAS] ADD CONSTRAINT [FK_COFUSUCODIGO] FOREIGN KEY ([COF_USUCODIGO]) REFERENCES [TB_USUARIOS] ([USU_CODIGO]) ON UPDATE NO ACTION ON DELETE NO ACTION
go


ALTER TABLE [TB_CARTAO_CREDITO] ADD CONSTRAINT [FK_CACVIGCODIGO] FOREIGN KEY ([CAC_VIGCODIGO]) REFERENCES [TB_VIGENCIA] ([VIG_CODIGO]) ON UPDATE NO ACTION ON DELETE NO ACTION
go


ALTER TABLE [TB_VIGENCIA] ADD CONSTRAINT [FK_VIGUSUCODIGO] FOREIGN KEY ([VIG_USUCODIGO]) REFERENCES [TB_USUARIOS] ([USU_CODIGO]) ON UPDATE NO ACTION ON DELETE NO ACTION
go




